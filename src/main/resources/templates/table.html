<!DOCTYPE html>
<html lang="en">
<head>
    <div th:replace="index :: fragment-header"></div>
</head>
<body>

<style>
    .td_style {
        text-align: center;
        padding-top: 30px;
        padding-bottom: 30px;
        /*border: solid black 1px;*/
        border-radius: 30px;
    }
</style>

<th:block th:if="${result != null}">
    <div>
        <th:block th:if="${!#lists.isEmpty(matches)}">
            <table align="center">
                <tr th:each="match: ${matches}">
                    <td class="td_style">
                        <h3>
                            <span th:text="${match.queueType}"></span>
                            <span th:text="${match.endTime}"></span>
                            <p>
                                <span th:if="${match.win == true}" style="color: blue">
                                    승리
                                </span>
                                <span th:if="${match.win == false}" style="color: red">
                                    패배
                                </span>
                                <span th:text="${match.gameDurationMinutes}"></span>분
                                <span th:text="${match.gameDurationSeconds}"></span>초
                            </p>
                        </h3>

                        <table style="margin-left: auto; margin-right: auto">
                            <tr>
                                <td>
                                    <img th:src="${match.myInfoDTO.championName}" width="100"
                                         style="border-radius: 70px">
                                </td>
                                <td>
                                    <div style="vertical-align: top">
                                        <img th:src="${match.myInfoDTO.spell1Id}" width="40">
                                    </div>
                                    <div style="vertical-align: bottom">
                                        <img th:src="${match.myInfoDTO.spell2Id}" width="40">
                                    </div>
                                </td>
                                <td>
                                    <div style="vertical-align: top">
                                        <img th:src="${match.myInfoDTO.primaryPerk}" width="40"
                                             style="background-color: black; border-radius: 70px">
                                    </div>
                                    <div style="vertical-align: bottom">
                                        <img th:src="${match.myInfoDTO.subPerk}" width="40">
                                    </div>
                                </td>
                                <td>
                                    <div style="vertical-align: top">
                                        <h2>
                                            <span th:text="${match.myInfoDTO.kills}"></span> /
                                            <span th:text="${match.myInfoDTO.deaths}"></span> /
                                            <span th:text="${match.myInfoDTO.assists}"></span>
                                        </h2>
                                    </div>

                                    <div style="vertical-align: bottom">
                                        <th:block th:each="item : ${match.myInfoDTO.items}">
                                            <img th:src="${item}" width="30">
                                        </th:block>
                                    </div>
                                </td>
                            </tr>
                        </table>


                        <div th:id="'loading' + ${match.matchId}" style="display: none; margin-top: 30px">
                            <img src="https://blog.kakaocdn.net/dn/bVlxDK/btq6lZaZ9u5/tt3SQWLkf692DbCsQMJS0k/img.gif">
                        </div>

                        <div style=" cursor:pointer; border: none; margin-top: 10px; margin-bottom: 10px">
                            <button type="button" th:id="'call' + ${match.matchId}"
                                    th:onclick="callDetailMatch([[${match.matchId}]])"
                                    style="background-color: rgba(0,0,0,0); cursor:pointer; border: none">
                                <img src="https://e7.pngegg.com/pngimages/184/620/png-clipart-arrow-down-about-line-finger-line-computer-icons-arrow-hand-about-line.png"
                                     style="max-width: 50px; max-height: 50px" alt="상세보기">
                            </button>
                            <button type="button"
                                    style="display:none;cursor:pointer; border: none"
                                    th:id="'showDetail' + ${match.matchId}"
                                    th:onclick="showDetail([[${match.matchId}]])">
                                <img src="https://w7.pngwing.com/pngs/433/937/png-transparent-up-arrow-android-computer-icons-up-arrow-angle-logo-number.png"
                                     style="max-width: 50px; max-height: 50px" th:id="'showButton' + ${match.matchId}"
                                     alt="숨기기">
                            </button>
                        </div>

                        <div th:id="showD + ${match.matchId}">
                            <div th:id="'detail' + ${match.matchId}" align="center"></div>
                        </div>
                    </td>
                </tr>
            </table>
        </th:block>
    </div>
</th:block>

<script>
    function callDetailMatch(matchId) {
        $.ajax({
            url: '/detail' + '/' + matchId,
            type: 'GET',
            beforeSend: function () {
                $('#loading' + matchId).show();
                $('#call' + matchId).hide();
                $('#showDetail' + matchId).hide();
            },
            complete: function () {
                $('#loading' + matchId).hide();
                $('#call' + matchId).hide();
                $('#showDetail' + matchId).show();
            },
        }).done(function (result) {
            $('#detail' + matchId).replaceWith(result);
        });
    }

    function showDetail(matchId) {
        if ($('#showD' + matchId).is(":visible")) {
            $('#showD' + matchId).hide();
            $('#showButton' + matchId).attr("src", "https://e7.pngegg.com/pngimages/184/620/png-clipart-arrow-down-about-line-finger-line-computer-icons-arrow-hand-about-line.png");
        } else {
            $('#showD' + matchId).show();
            $('#showButton' + matchId).attr("src", "https://w7.pngwing.com/pngs/433/937/png-transparent-up-arrow-android-computer-icons-up-arrow-angle-logo-number.png");
        }
    }
</script>

</body>
</html>